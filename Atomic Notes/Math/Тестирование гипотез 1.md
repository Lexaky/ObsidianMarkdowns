**Created at** [17-12-2025 22:53]
**Tags**: #Математическая_статистика 
# Тестирование гипотез о равенстве средних двух генеральных совокупностей. t-тесты

#### Доверительный интервал для среднего. Выборка из нормального распределения
Пусть $x_1, ..., x_n$ - случайная выборка из нормально распределённой ГС;
Величина $\sqrt n ({\bar x - \mu \over \sigma}) \approx N(0, 1) => (\bar x - \frac \sigma {\sqrt n} z_\alpha; \bar x + \frac \sigma {\sqrt n} z_\alpha)$
При неизвестной дисперсии:
$\sqrt n ({\bar x - \mu \over \sigma}) \approx T(n - 1)$ - распределение Стьюдента $(n - 1)$ степеней свобод
$$(\bar x - \frac s {\sqrt n} t_\alpha (n-1); \bar x + \frac s {\sqrt n} t_\alpha (n-1))$$
Здесь $t_\alpha (n-1)$ - квантиль распределения Стьюдента уровня $1 - \alpha / 2$ с $(n - 1)$ степенью свободы.

#### Распределение Стьюдента vs нормальное распределение
![[Тестирование_гипотез_распределение_Стьюдента_и_нормальное.png]]
* По форме очень похоже на нормальное распределение, но с более тяжёлыми хвостами;
* Зависит от размера выборки: чем больше выборка, тем ближе к нормальному распределению;
* Параметр распределения $df$ - степени свободы (degrees of freedom);
* $df = n - 1$, где $n$ - это размер выборки.

#### Гипотеза о равенстве средних двух генеральных совокупностей
t-критерий Стьюдента - один из наиболее давно разработанных и широко используемых статистических критериев. Чаще всего он применяется для проверки нулевой гипотезы о равенстве средних значений двух совокупностей. Существует и одновыборочная модификация двух совокупностей.
Основные допущения t-критерия Стьюдента:
* Сравниваемые выборки происходят из нормально распределённых совокупностей. Не принципиально для больших выборок (т.к. Центральная Предельная Теорема);
* Дисперсии сравниваемых генеральных совокупностей равны;
* Выборки независимы (исходная форма t-критерия).

#### Одновыборочный вариант t-критерия Стьюдента
Проверки нулевой гипотезы о равенстве среднего значения ($\mu_0$) генеральной совокупности, из которой была взята выборка, некоторому известному значению ($\mu$):
$$H_0: \mu = \mu_0$$
В общем виде проверка ($=$ тест) этой гипотезы выполняется при помощи $t$-критерия, который рассчитывается как отношение разницы между выборочным средним и известным значением к стандартной ошибке выборочного среднего:
$$t = {\bar x - \mu \over s / \sqrt n}$$
При неизвестной дисперсии: $\sqrt n ({x - \mu \over s}) \approx T(n - 1)$ - распределение Стьюдента $(n-1)$ ст. св.
$$(\bar x - \frac s {\sqrt n} \cdot t_\alpha (n-1); \bar x + \frac s {\sqrt n} \cdot t_\alpha (n-1))$$
Здесь $t_\alpha (n-1)$ - квантиль распределения Стьюдента уровня $1-\alpha / 2$ с $(n-1)$ степенью свободы.

Если значение t попадает в область отклонения нулевой гипотезы, то отвергаем проверяемую нулевую гипотезу. Область отклонения нулевой гипотезы для критерия Стьюдента определяется заранее принятым уровнем значимости (например, $\alpha = 0.05$) и числом степеней свободы
![[Тестирование_гипотез_области_отклонения_принятия.png]]
Эквивалентный подход к интерпретации результатов теста: допустив, что нулевая гипотеза верна, можно рассчитать, насколько велика вероятность получить t-значение, равное или превышающее то, которое получилось по имеющимся выборочным данным. Если эта вероятность оказывается меньше, чем заранее принятый уровень значимости (например, $p < 0.05$), мы вправе отклонить проверяемую нулевую гипотезу.

#### Сравнение двух независимых выборок (t-test с поправкой Уэлча)
При сравнении двух выборок проверяемая нулевая гипотеза состоит в том, что обе эти выборки происходят из генеральных совокупностей с одинаковыми средними значениями:
$H_0: \mu_1 = \mu_2$
Поскольку эти генеральные средние мы оцениваем при помощи выборочных средних значений, формула t-критерия приобретает вид:
$$t = {\bar X_1 - \bar X_2 \over \sqrt {\frac {s_1^2}{n_2} + \frac {s_2^2}{n_2}}}$$
Где $s_\Delta^2 = {\frac {s_1^2}{n_2} + \frac {s_2^2}{n_2}}$ - несмещённая оценка дисперсии разности выборочных средних. Эта статистика при справедливой нулевой гипотезе имеет распределение $t(df)$, где:
$$df = {(s_1^2/n_1 + s_2^2/n_2)^2 \over (s_1^2/n-1)^2 / (n_1 - 1) + (s_2^2/n_2)^2 / (n_2 - 1)}$$
#### Сравнение двух независимых выборок (t-test - классический вариант)
При сравнении двух выборок проверяемая нулевая гипотеза состоит в том, что обе эти выборки происходят из генеральных совокупностей с одинаковыми средними значениями:
$H_0 = \mu_1 = \mu_2$
В случае, если дисперсии выборок предполагаются одинаковыми, то:
$$V(\Delta) = \sigma ^ 2 ({1 \over n_1} + {1 \over n_2})$$
Тогда $t$-статистика: $t = {\bar X_1 - \bar X_2 \over s_x \sqrt{\frac 1 n_1 + \frac 1 n_2}}$, $s_x = \sqrt {(n_1 - 1)s_1^2 + (n_2 - 1)s_2^2 \over n_1 + n_2 - 2}$
Эта статистика при справедливой нулевой гипотезе имеет распределение $t(n1 + n2 - 2)$

#### Сравнение двух зависимых (или парных) выборок
Зависимыми (или парными) являются две выборки, содержащие результаты измерений какого-либо количественного признака, выполненных на одних и тех же объектах. Во многих исследованиях какой-то определённый отклик измеряется у одних и тех же объектов до и после экспериментального воздействия.
Например, частота пульса у одних и тех же пациентов до и после физической нагрузки; вес человека до диеты и после.

При такой схеме эксперимента исследователь более точно оценивает эффект воздействия именно потому, что прослеживает его у одних и тех же объектов. Нас интересуют свойства выборки, составленной из разностей значений признака у одних и тех же объектов, или "истинная средняя разность" как результат экспериментального воздействия (обозначим его $\delta$).
Если верна нулевая гипотеза: $H_0: \delta = 0$, то нет оснований предполагать, что эффект воздействия имеет место. Тогда формула для парного критерия Стьюдента:
$$t = {\bar d \over s/\sqrt n} : s = \sqrt {{1 \over n -1} \sum_{i=1}^n (d_i - \bar d)^2}: d_i = x_{2i} - x_{1i}$$
Двувыборочный зависимый t-тест - это то же самое, что и одновыборочный t-тест, только для разницы между связанными значениями: $df = n-1$

#### Двусторонние гипотезы vs Односторонние гипотезы

Зачастую неизвестно, в какой из совокупностей рассматриваемый параметр будет больше, а какой меньше. Например, если сравнивают средние оценки учащихся в контрольной и экспериментальной группах, то заранее неизвестно, в какой группе средняя оценка будет больше. В этом случае нулевая гипотеза состоит в том, что средние равны между собой, а цель исследования - доказать обратное, т.е. выявить различие между средними. При этом допускается, что различие может быть любого знака. Такие гипотезы называются **двусторонними**.

Но иногда задача состоит в том, чтобы доказать увеличение или уменьшение параметра. Например, средний результат в экспериментальной группе выше (ниже), чем в контрольной. При этом уже не допускается, что различие может быть другого знака. Тогда альтернативная гипотеза: $H_1: \mu_1 > \mu_2$ при нулевой: $H_0: \mu_1 \le \mu_2$ (или $H_1: \mu_1 < \mu_2$, если нулевая $H_0: \mu_1 \ge \mu_2$). Такие гипотезы называются **односторонними**.

Решение об отклонении гипотезы $H_0$ принимается, если разность $\bar x_2 - \bar x_1$ выходит за пределы некоторого значения $t^*$ двустороннего критерия (допустимы отклонения в обе стороны от нуля). Ошибка, которая при этом допускается, равна уровню значимости $\alpha$.
Отклонения возможны в обе стороны, поэтому при симметричном распределении вероятности отклонений, больших $t_{\alpha/2}$ и меньших $t_{\alpha/2}$, будут одинаковы и составят $\alpha/2$.

Если предположить, что в экспериментальной группе будут показаны в среднем более высокие результаты, то можно выдвинуть одностороннюю альтернативу. В этом случае при той же нулевой гипотезе распределение разности будет таким же, как и для двустороннего критерия. Но теперь представляют интерес только положительные значения разности $\bar x_2 - \bar x_1$
Решение об отклонении $H_0$ принимается, когда $\bar x_2 - \bar x_1$ окажется больше некоторого значения $t_\alpha$ одностороннего критерия. При том же уровне значимости $t_\alpha$ будет всегда меньше $t_{\alpha/2}$, поэтому нулевая гипотеза будет отклоняться чаще при одностороннем критерии.

Двусторонние критерии оказываются более консервативными, чем односторонние.

Уровни значимости при двустороннем\одностороннем критериях:
![[Тестирование_гипотез_однодву_критерии.png]]


#### Мощность t-тестов
![[Тестирование_гипотез_мощность_тестов.png]]
Число $\chi = (1 - \beta)$, равное вероятности отвержения неверной нулевой гипотезы $H_0$, называется статистической мощностью критерия. Эта вероятность соответствует площади фигуры, образованной графиком функции.
Мощность критерия отражает чувствительность диагностического теста, т.е. вероятность того, что в эксперименте будет найдено статистически достоверное различие, когда это различие действительно существует.

![[Тестирование_гипотез_мощность_тестов_2.png]]

Чувствительность критерия Стьюдента в зависимости от параметра нецентральности $\phi$ при уровне значимости $\alpha = 0.05$ для разных объёмов выборок $n$. Параметр нецентральности - это отношение величины различий к стандартному отклонению в совокупности: $\phi = \delta / \sigma$.

Если, например, величина различий $\delta = 200$, стандартное отклонение $\sigma = 200$, то $\phi = 1$. Для объёма выборок $n = 10$ чувствительность составляет $0,55$.
При $\phi = 0,55$ и $n = 0$ чувствительность - всего лишь $0,16$
![[Тестирование_гипотез_мощность_тестов_3.png]]

Параметр нецентральности $\phi$ или минимальное стандартизованное различие определяется как отношение $\frac d s$, где $d$ - абсолютное значение средней разности между сравниваемыми группами, $s$ - известное априори среднеквадратичное отклонение изучаемого показателя у данной категории экспериментальных единиц.
На практике обычно (не всегда) приемлемой считается мощность теста $\chi \ge 80\%$ (что соответствует $\beta$-риску в $20\%$). Этот уровень является следствием так называемого "соотношения 1 к 4" между уровнями $\alpha$-риска и $\beta$-риска: если принять уровень значимости $\alpha=0.05$, тогда $\beta = 0.05 \times 4 = 0.20$ и мощность критерия составит $\chi = 1 - 0.20 = 0.80$.

Приняв во внимание эти закономерности, мы можем заранее (т.е. до проведения исследования) по представленной номограмме определить, например, минимальный размер выборок, нужный для выявления эффекта.

Если в ходе выполнения t-теста проверяемая нулевая гипотеза не отклонена, это не значит, что эффект в действительности отсутствует. Возможно, объёмы выборок были просто недостаточно велики для этого.

Поэтому рекомендуется приводить не только результаты статистического теста, но и информацию о его мощности (оценённую до проведения исследования).

#### Проверка однородности дисперсии
F-критерий Фишера (F-тест) - используется для сравнения дисперсий двух нормально распределённых генеральных совокупностей:
$$H_0: \sigma_1^2 = \sigma_2^2$$
Генеральные дисперсии оцениваются по выборкам, статистика критерия:
$$F = {s_1^2 \over s_2^2}$$
На практике в числитель обычно помещают бОльшую дисперсию, а в знаменатель - меньшую. При верной $H_0$ значение $F$ близко к единице. Критическое значение определяется из распределения Фишера.
Основные допущения F-критерия Фишера:
* Сравниваемые выборки происходят из нормально распределённых совокупностей;
* Выборки независимы.

#### Ссылки
1. [Лекции по математическим методам анализа данных 2025]( https://cloud.mail.ru/public/T6ge/9337oqgK3)